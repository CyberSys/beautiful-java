#!/bin/bash

cd "$(dirname ${0})"
cd ..

VERSION="${1}"
if [ -z "${VERSION}" ]; then
	echo Please choose version. Available versions are:
	ls -1 sources | sed 's/^/  - /'
	exit
fi

SOURCES="sources/${VERSION}"
OUTDIR="javadoc/${VERSION}"

rm -rf "${OUTDIR}"
mkdir -p "${OUTDIR}"

PACKAGES=$(grep --binary-files=text -R ^package "${SOURCES}" | cut -f 2 -d: | sed -e 's/^package //' -e 's/;$//' | sort -u | tr '\n' ' ')
javadoc -source 8 -Xdoclint:none -cp "zlib/${VERSION}:zlib/${VERSION}/*" -d "${OUTDIR}" --source-path "${SOURCES}/" ${PACKAGES}
